<!-- This HTML file shows how to embed a bubbletree component in a regular HTML page -->
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <link rel="stylesheet" href="../lib/bootstrap-superhero.min.css" />
    <link rel="stylesheet" href="../lib/dataTables.bootstrap4.min.css" />
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.3.1/dist/leaflet.css"
          integrity="sha512-Rksm5RenBEKSKFjgI3a41vrjkw4EVPlJ3+OiI65vTjIdo9brlAacEuKOiQ5OFh7cOI1bkDwLqdLw3Zg0cRJAAQ=="
          crossorigin="" />
    <style>
        h2 {
            padding-top: 1em;
        }
    </style>
</head>
<body>
    <h1>D3.js-based Visualization components</h1>
    <h2>Bubble Tree component</h2>
    <button onclick="c.selectData(function(d) { console.info(d); console.info(d.name=='test1'?1:d.name=='test2'?0.5:0); return d.name=='test1'?1:d.name=='test2'?0.5:0; })">Click me to select nodes</button>
    <span id="sr"></span>

    <div style="display: flex; flex-direction: row;height: 300px">
        <div style="display: flex; flex-direction: column; width: 30%; border: black dotted 1px;">
            <svg id="bubbletree1"></svg>
        </div>
        <div style="display: flex; flex-direction: column; width: 70%; border: black dotted 1px;">
            <svg id="bubbletree2"></svg>
        </div>
    </div>

    <h2>Table component</h2>
    <div id="table">
    </div>

    <h2>List component</h2>
    <div id="list" style="max-height:300px;overflow-y:scroll"></div>

    <h2>Time Series component</h2>
    <div id="ts" style="width:100%;height:400px"></div>

    <h2>Earth Model</h2>
    <div id="earth-3d" style="width:100%;height:600px"></div>

    <!--<script src="../lib/d3.v4.min.js"></script>
    <script src="../lib/jquery-1.12.4.js"></script>-->
    <script src="../dist/visualization-components-bundle.js"></script>
    <script src="../lib/bootstrap.bundle.min.js"></script>
    <script src="../lib/jquery.dataTables.min.js"></script>
    <script src="../lib/dataTables.bootstrap4.min.js"></script>
    
    <script>

        var data = {
            "name": "clustering",
            "children": [
                {
                    "name": "cluster 1",
                    "children": [
                        {
                            "name": "sub cluster 1",
                            "children": [
                                {
                                    "name": "test1",
                                    "weight": 3938
                                },
                                {
                                    "name": "test2",
                                    "weight": 3812
                                },
                                {
                                    "name": "test3",
                                    "weight": 6714
                                }
                            ]
                        },
                        {
                            "name": "sub cluster 2",
                            "children": [
                                {
                                    "name": "test 4",
                                    "weight": 3534
                                },
                                {
                                    "name": "Test 5",
                                    "weight": 5731
                                },
                                {
                                    "name": "Test 6",
                                    "weight": 7840
                                }
                            ]
                        }
                    ]
                },
                {
                    "name": "cluster 2",
                    "weight": 3812
                },
                {
                    "name": "cluster 3",
                    "weight": 6000
                }
            ]
        };

        c = new arnd.BubbleTree();
        c.build({
            container: document.getElementById("bubbletree1"),
            data: data,
            handlers: {
                "click": function (d) {
                    console.info(">> " + d.data);
                },
                "mouseover": function (d) { console.info("mouseover"); },
                "dblclick": function (d) { console.info("dblclick"); },
            },
            selectOnClick: true,
            showRoot: true
        });

        c = new arnd.BubbleTree();
        c.build({
            container: document.getElementById("bubbletree2"),
            data: data,
            handlers: {
                "click": function (d) {
                    console.info(">> " + d.data);
                },
                "mouseover": function (d) { console.info("mouseover"); },
                "dblclick": function (d) { console.info("dblclick"); }
            },
            selectOnClick: true,
            showRoot: true,
            nodePopover: function (d, callback) {
                console.info(d);
                callback({ title: "Node", content: d.data.name });
            }
        });

        var t = new arnd.Table();
        t.build({
            container: document.getElementById("table"),
            striped: true,
            bordered: true,
            selectableRows: true,
            rowClickHandler: function (r) { console.info(r); },
            data: [{ "a": "1", "b": "2" }, { "a": "3", "b": "4" }]
        });

        l = new arnd.List();
        l.build({
            container: document.getElementById("list"),
            selectableRows: true,
            rowClickHandler: function (r) { console.info(r); },
            data: ["element 1", "element 2", "element 3", "element 4", "element 5", "element 6", "element 7", "element 8", "element 9", "element 10"]
        });

        l = new arnd.TimeSeries();
        l.build({
            container: document.getElementById("ts"),
            data: [{ x: new Date("2018-1-1"), y: 10 , description:"This is a description"}, { x: new Date("2018-2-1"), y: 10, a: 1 }, { x: new Date("2018-3-1"), y: 8 }, { x: new Date("2018-4-1"), y: 11 }, { x: new Date("2018-5-1"), y: 9 }],
            options: {}
        });

        var unzoomAction_FR = [
            'dézoomer',
            'retour',
            'annuler',
            'saucisse'
        ];
        var sr = new arnd.SimpleSpeechRecognition();
        sr.build({
            container: document.getElementById("sr"),
            language: "fr-FR",
            onSpeechRecognized: function (results) {
                let uids = c.lookupNames(results);
                //console.info(uids);
                if (uids.length > 0) {
                    c.zoomToId(uids[0]);
                } else {
                    if (unzoomAction_FR.indexOf(results[0]) >= 0) {
                        c.zoomBack();
                    }
                }
            }
        });

        var earth = new arnd.Earth();
        earth.build({
            container: document.getElementById("earth-3d"),
            data: [{ uid: "paris", value: "paris", lat: 48.866667, long: 2.333333 }, { uid: "madrid", value: "madrid", lat: 40.416775, long: -3.703790 }, { uid: "new-york", value: "new-york", lat: 40.730610, long: -73.935242 }],
        });

    </script>
</body>
</html>